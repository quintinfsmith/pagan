fixed: effect sometimes being incorrectly applied late or early
